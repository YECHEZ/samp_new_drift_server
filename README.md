# samp_new_drift_server
by Remarion

Руководство написано скриптером-редактором данного игрового
мода.

Компания [Gn_R] представляет Вам новый дритф сервер, на
этот раз - для разработчиков дрифт серверов. Хотя, этот
сервер на все 100% можно считать продуктом "включил и ра-
ботай" (как и многие моды и скрипты от [Gn_R]).

Сервер создавался на базах известных дрифт серверов, таких
как: Дрифт + ДМ сервер, РУССКИЙ ДРИФТ СЕРВЕР ЗАХОДИ, и
NEW Drift Life v6.0.

Что есть на этом сервере ?

1. Авто-бан айпи адреса двух разных игроков с одного и того
   же айпи.
2. Авто-бан гиперциклового подключения-отключения игрока
   (реконнект).
3. Авто-кик, если не заспавнился в течение трёх минут.
4. Авто-кик за смену ника.
5. Авто-кик за побег из тюрьмы (или из-под стражи).
6. Авто-кик, если 15 минут был в AFK.
7. Авто-кик за чит на деньги.
8. Авто-кик за чит на очки (SCORE).

Как Вы уже заметили, на этом сервере была добавлена система
очков игрока (SCORE). Кроме этого - на сервере была остав-
лена стандартная система денег (GivePlayerMoney) и был сделан
для неё античит, такой же античит был сделан и для системы
очков игрока (SCORE). Админка на сервере - встроенная
(12 лвл). В админке есть команды для управления очками игро-
ков, и есть возможность давать обычным игрокам\забирать у
обычных игроков временный админский ГМ. 7-й слот оружки (Ра-
кетная установка, РПГ, Огнемёт, Minigun) - открыт для всех
игроков. Вся оружка и предметы - сохраняются в файлах акка-
унтов игроков. Файлы аккаунтов сделаны на системе MXini.
Для самостоятельного развития сервера, в аккаунты игроков
были добавлены 6 систем фракций. Данные для каждой фракции,
это - 2 переменные целого типа, 4 переменных вещественного
типа (для сохранения координат и угла поворота), 1 перемен-
ная строкового типа. Одна из 6 фракций уже использована на
этом сервере - в качестве примера туда подключена встроенная
система банд. Системы домов, и бизнесов - были "вынесены" на
скрипты. Так же в скриптах есть: дритф-счётчик (drift), спи-
дометр (speedometer), скрипт дополнительных объектов (для
"постройки" баз для банд) (myobj), скрипт управления движу-
щимися объектами (воротами для баз) (gatesys2), скрипт рек-
ламы сервера (reklama). Бан-лист находится в корневой папке
сервера (samp.ban).

Система регистрации\логирования и меню сервера - были взяты
из "Дрифт + ДМ" мода. Цветовая схема чата, карты сервера, и
телепорты - были взяты из "Реновации РУССКИЙ ДРИФТ СЕРВЕР
ЗАХОДИ" мода. Место выбора начального скина, частичные цвето-
вые схемы меню, и окно сообщения /ahelp - были взяты из
"NEW Drift Life v6.0" мода.

Про начальную настройку сервера:

1). строка 9 - авто-кик игроков за спам в чате (или в коман-
    дах) + авто-кик игроков-читеров за спам вызовами функций.
    В этой настройке можно задать авто-кик таких игроков,
    или игроков-читеров (авто-кик может быть полезным, когда
    на сервере бесконтрольно спамят обычные игроки, или же
    бесконтрольно спамят вызовами функций игроки-читеры. Если
    использовать настройку "БЕЗ авто-кика" - то при спаме в
    чате (или в командах) + при спаме вызовами функций будет
    автоматически включаться пятисекундная задержка чата (или
    команд), или пятисекундная задержка вызовов функций.
2). строка 24 - максимум игроков (так же, нужно будет поме-
    нять максимум игроков и во всех скриптах (если там есть
    эта настройка)).
3). строка 31 - максимум банд (не больше 1000).
4). строка 33 - максимум радиостанций (радио) на сервере.
5). строки 341-344 - основные настройки конфига сервера (имя,
    пароль, имя карты, имя вэб-странцы сервера.
6). строка 345 - час перезагрузки сервера (1 раз в сутки, в
    начале этого часа, сервер будет автоматически перезагру-
    жаться: "resthour = 3;" - перезагрузка в 3 часа ночи).
7). строки 346-361 - список подключенных скриптов сервера.
8). строки 492-503 - URL-ссылки на радиостанции.
9). строки 505-516 - названия радиостанций.

Про начальную настройку системы домов (скрипт GarHouse):

1). строка 16 - максимум игроков.
2). строка 62 - максимум домов (не больше 1000).
3). строка 64 - число домов, которое может купить один игрок
    (не больше 10).

На сервере есть возможность оперативной замены данных аккаунта
любого игрока (на работающем сервере) без входа на сам сервер
(через FTP-доступ - если сервер работает на выделенном хосте).
Причём, эта замена работает как для офф-лайн, так и для
он-лайн аккаунтов. Замена делается следующим образом: в ката-
лог scriptfiles\players\aimport нужно скопировать файл с дан-
ными для замены; после 2-3 секунд - работающий сервер сделает
все необходимые действия; удалит файл с данными для замены; и
запишет в этот же самый каталог scriptfiles\players\aimport
файл ответа. Сервер может за один раз обрабатывать от 1 до 10
файлов для замены данных в аккаунтах. При этом, на обработку
каждого файла будет уходить 2-3 секунды. Имена файлов с данным
для замены должны быть: "0.txt", "1.txt", "2.txt", "3.txt",...
"9.txt". Как видно из примера - тип файлов "txt" - это обычный
текстовый документ. Для каждого файла с данными для замены -
будет автоматически формироваться файл ответа (только на рабо-
тающем сервере !!!). Имена файлов-ответов: "0-ret.txt",
"1-ret.txt", "2-ret.txt", "3-ret.txt",... "9-ret.txt". Как
видно из примера - тип файлов "txt" - это обычный текстовый
документ. Пример файла с данными для замены:

Name = play1
AdminLevel = 3
AdminShadow = 1
AdminLive = 0

Name = play1 - где: Name - ключ имени игрока, play1 - ник иг-
рока (или имя аккаунта) - в котором нужно заменить данные. 
AdminLevel = 3 - даст игроку play1 3 лвл админа.
AdminShadow = 1 - даст игроку (админу) play1 скрытость админа.
AdminLive = 0 - выключит игроку (админу) play1 бессмертие.

Всего можно заменять 11 типов данных:

1.  "Key" - новый пароль для игрока.
2.  "AdminLevel" - от 1 до 10 - новый лвл админа, 0 - снятие
    любого лвл админа.
3.  "AdminShadow" - 0 - снять скрытость админа, 1 - дать адми-
    ну скрытость.
4.  "AdminLive" - 0 - выключить бессмертие, 1 - включить бес-
    смертие (для игрока - временное бессмертие - заменяется
    только для он-лайн игрока !).
5.  "Prisonsec" - от 0 до 3 - освободить игрока из тюрьмы,
    от 4 до 2147483640 - новые секунды тюрьмы.
6.  "Mutedsec" - от 0 до 3 - разоткнуть игрока, от 4 до
    2147483640 - новые секунды затыка.
7.  "Money" - от -2147483640 до 2147483640 - новая денежная
    сумма игрока.
8.  "Score" - от -2147483640 до 2147483640 - новые очки игро-
    ка.
9.  "Lock" - 1 - заблокировать аккаунт (бан), 0 - разблокиро-
    вать аккаунт (разбан).
10. "Frac1" - -600 - запретить приглашать себя в банду (игрок
    не в банде), 0 - разрешить приглашать себя в банду (игрок
    не в банде), от 1 до XXX* - ид банды игрока.
11. "FracLvl1" - 0 - игрок не в банде, от 1 до 6 - лвл в бан-
    де.
--------------------------------------------------------------
XXX* - максимальное количество банд (не больше 1000), задаётся
в 31 строке мода сервера.
--------------------------------------------------------------

В любом файле с данными для замены - может быть от 1 до 11
типов данных. Причём, типы данных для замены - можно использо-
вать в любых комбинациях, но строка "Name = <имя игрока>" -
является обязательной строкой (!!!), и она должна быть в любом
файле с данными для замены. В файле ответа - будет единствен-
ная строка "ret = <описание ошибки, или ок>". Описывать каждую
ошибку будет излишне, т.к. в файле ответа будет дана исчерпы-
вающая информация по каждой возможной ошибке. После прочтения
- файл ответа можно удалить. Если файл ответа не удалять - то,
при определённых обстоятельствах - старый файл ответа будет
удалён, и на его место будет записан новый файл ответа.

Про настройки других скриптов - читайте в началах других
скриптов. Если что не понятно - спросите знакомого скриптера
- Вам помогут. Помощь по админкам - в файле "Помощь по админ-
кам (New Drift).txt"

В папке "Дополнительно" - лежат ядра 0.3e, 0.3x, 0.3z, и
0.3.7 серверов для Виндус и для Линукс систем, а так же - би-
блиотеки msvcp100 и msvcr100 (на случай, если у Вас не уста-
новлен NET Framework и запуск сервера на компьютере идёт с
ошибкой).

О "пиварах" (глобальных переменных):

В скриптах сервера можно использовать чтение глобальных пе-
ременных целого типа (для каждого игрока): "AdmLvl" - уро-
вень админки игрока, "PlGng" - ид банды игрока, "PlGLvl" -
уровень игрока в банде, "SecPris" - текущее число секунд
тюрьмы, "SecMute" - текущее число секунд затыка, "PlSkin" -
ид скина игрока, "PlFrost" - текущий статус заморозки игрока
(0 - НЕ заморожен, 1 - заморожен).

И на последок.....

Как запустить сервер на своём компьютере:

1. Нужно запустить файл "samp-server.exe" в корневой папке.
   Если открылось чёрное окно с белыми буквами - значит всё
   нормально. Если есть окна с ошибками: "приложению не уда-
   лось запуститься....." - то: закройте чёрное окно, затем
   скопируйте файлы "msvcp100.dll" и "msvcr100.dll" из папки
   "Дополнительно" в папку "C:\Windows\system32\", и снова
   запустите файл "samp-server.exe".

Теперь добавляем в клиент мультиплеера свой айпи адрес
(свой айпи можно узнать на сайте 2ip.ru , или можно написать
адрес локальной машины по умолчанию 127.0.0.1). Если в строке
Вашего мультиплеера появился сервер "New Drift сервер", то
заходите на свой сервер))).

Как себя сделать главным админом:

1. Нужно залогиниться как РКОН администратор (/rcon login ваш
   РКОН-пароль, если Вы не меняли РКОН-пароль сервера в файле
   конфигурации, то: /rcon login 112233)
2. Нужно написать команду выдачи главной админки самому себе:
   /makeadmin [Ваш ид] 12 . Например, Вы зашли на сервера как
   ид 5 - тогда: /makeadmin 5 12 .

Компания [Gn_R] желает Вам приятной игры и удачных разработок
дрифт серверов))).

август 2016 г.
